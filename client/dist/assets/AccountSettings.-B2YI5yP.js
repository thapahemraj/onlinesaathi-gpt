import{a1 as e,cM as a,ee as s,ef as t,eg as i,eh as r,ei as n,ej as o,ek as l,el as c}from"./vendor.CphWSTLN.js";import{useState as d,useEffect as m,useRef as x,memo as u}from"react";import{useToastContext as p,Switch as v,useMediaQuery as h,GearIcon as j,SpeechIcon as f,PersonalizationIcon as b,DataIcon as g,UserIcon as _,Avatar as y,DropdownMenuSeparator as N,LinkIcon as w}from"@librechat/client";import{a as A,b as k,d as C,e as O,m as E,f as T,g as L,h as I,c as z,G as M,C as F,i as D,S,D as P,j as R,A as H,k as U,l as q,M as G}from"./index.2tWY7dSo.js";import"./utilities.BTNfF1ni.js";import{h as B,j as Z,k as K,g as V}from"./radix-ui.DdkHAinG.js";import{a as W,L as J,F as Q,q as X,z as Y}from"./headlessui.Dg00_BJ1.js";import"./markdown_highlight.YFvJ8PVJ.js";import"react-dom";import"./react-interactions.C2rPp_t4.js";import"./validation.xig1VQ4I.js";import"./math-katex.steiuUVT.js";import"./http-client.DhyQNT5o.js";import"./locales.DcNwsKmV.js";import"i18next";import"react-i18next";import"./i18n.CE40c5bP.js";import"./routing.CVoMIF_b.js";import"./tanstack-vendor.DVV4vUjY.js";import"./date-utils.j-oxXFG2.js";import"./forms.DHEhur4C.js";import"./security-ui.DXoq3Ng6.js";import"./heic-converter.Cz_Prg7D.js";import"./animations.BUCsF4W9.js";import"./markdown-processing.6SqW5JNx.js";import"./codemirror-core.Db-SEkBm.js";import"./codemirror-state.BpbzyhTO.js";import"./codemirror-view.BXpYK4Vr.js";import"./codemirror-language.BxChQYYl.js";import"./sandpack.pmh-9YB0.js";import"./virtualization.B4GvZnf2.js";import"framer-motion";function $({hasMemoryOptOut:a,hasAnyPersonalizationFeature:s}){var t;const i=A(),{showToast:r}=p(),{data:n}=k(),[o,l]=d(!0),c=C({onSuccess:()=>{r({message:i("com_ui_preferences_updated"),status:"success"})},onError:()=>{r({message:i("com_ui_error_updating_preferences"),status:"error"}),l((e=>!e))}});m((()=>{var e;void 0!==(null==(e=null==n?void 0:n.personalization)?void 0:e.memories)&&l(n.personalization.memories)}),[null==(t=null==n?void 0:n.personalization)?void 0:t.memories]);return s?e.jsx("div",{className:"flex flex-col gap-3 text-sm text-text-primary",children:a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-b border-border-medium pb-3",children:e.jsx("div",{className:"text-base font-semibold",children:i("com_ui_memory")})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{id:"reference-saved-memories-label",className:"flex items-center gap-2",children:i("com_ui_reference_saved_memories")}),e.jsx("div",{id:"reference-saved-memories-description",className:"mt-1 text-xs text-text-secondary",children:i("com_ui_reference_saved_memories_description")})]}),e.jsx(v,{checked:o,onCheckedChange:e=>{l(e),c.mutate({memories:e})},disabled:c.isLoading,"aria-labelledby":"reference-saved-memories-label","aria-describedby":"reference-saved-memories-description"})]})]})}):e.jsx("div",{className:"flex flex-col gap-3 text-sm text-text-primary",children:e.jsx("div",{className:"text-text-secondary",children:i("com_ui_no_personalization_available")})})}function ee({open:i,onOpenChange:r}){var n,o;const l=h("(max-width: 767px)"),{data:c}=L(),m=A(),[u,p]=d(I.GENERAL),v=x({}),{hasAnyPersonalizationFeature:y,hasMemoryOptOut:N}=function(){const e=O({permissionType:E.MEMORIES,permission:T.OPT_OUT});return{hasMemoryOptOut:e,hasAnyPersonalizationFeature:e}}(),w=[{value:I.GENERAL,icon:e.jsx(j,{}),label:"com_nav_setting_general"},{value:I.CHAT,icon:e.jsx(a,{className:"icon-sm","aria-hidden":"true"}),label:"com_nav_setting_chat"},{value:I.COMMANDS,icon:e.jsx(s,{className:"icon-sm","aria-hidden":"true"}),label:"com_nav_commands"},{value:I.SPEECH,icon:e.jsx(f,{className:"icon-sm","aria-hidden":"true"}),label:"com_nav_setting_speech"},...y?[{value:I.PERSONALIZATION,icon:e.jsx(b,{}),label:"com_nav_setting_personalization"}]:[],{value:I.DATA,icon:e.jsx(g,{}),label:"com_nav_setting_data"},...(null==(n=null==c?void 0:c.balance)?void 0:n.enabled)?[{value:I.BALANCE,icon:e.jsx(t,{size:18}),label:"com_nav_setting_balance"}]:[],{value:I.ACCOUNT,icon:e.jsx(_,{}),label:"com_nav_setting_account"}];return e.jsx(W,{appear:!0,show:i,children:e.jsxs(J,{as:"div",className:"relative z-50",onClose:r,children:[e.jsx(Q,{enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black opacity-50 dark:opacity-80","aria-hidden":"true"})}),e.jsx(Q,{enter:"ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-100",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsx("div",{className:z("fixed inset-0 flex w-screen items-center justify-center p-4"),children:e.jsxs(X,{className:z("max-h-[90vh] overflow-hidden rounded-xl rounded-b-lg bg-background pb-6 shadow-2xl backdrop-blur-2xl animate-in sm:rounded-2xl md:w-[680px]"),children:[e.jsxs(Y,{className:"mb-1 flex items-center justify-between p-6 pb-5 text-left",as:"div",children:[e.jsx("h2",{className:"text-lg font-medium leading-6 text-text-primary",children:m("com_nav_settings")}),e.jsxs("button",{type:"button",className:"rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-border-xheavy focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-surface-primary dark:focus:ring-offset-surface-primary",onClick:()=>r(!1),children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5 text-text-primary",children:[e.jsx("line",{x1:"18",x2:"6",y1:"6",y2:"18"}),e.jsx("line",{x1:"6",x2:"18",y1:"6",y2:"18"})]}),e.jsx("span",{className:"sr-only",children:m("com_ui_close_settings")})]})]}),e.jsx("div",{className:"max-h-[calc(90vh-120px)] overflow-auto px-6 md:w-[680px]",children:e.jsxs(B,{value:u,onValueChange:e=>{p(e)},className:"flex flex-col gap-10 md:flex-row",orientation:"vertical",children:[e.jsx(Z,{"aria-label":"Settings",className:z("min-w-auto max-w-auto relative -ml-[8px] flex flex-shrink-0 flex-col flex-nowrap overflow-auto sm:max-w-none",l?"flex-row rounded-xl bg-surface-secondary":"sticky top-0 h-full"),onKeyDown:e=>{var a;const s=[I.GENERAL,I.CHAT,I.COMMANDS,I.SPEECH,...y?[I.PERSONALIZATION]:[],I.DATA,...(null==(a=null==c?void 0:c.balance)?void 0:a.enabled)?[I.BALANCE]:[],I.ACCOUNT],t=s.indexOf(u);switch(e.key){case"ArrowDown":e.preventDefault(),p(s[(t+1)%s.length]);break;case"ArrowUp":e.preventDefault(),p(s[(t-1+s.length)%s.length]);break;case"Home":e.preventDefault(),p(s[0]);break;case"End":e.preventDefault(),p(s[s.length-1])}},children:w.map((({value:a,icon:s,label:t})=>e.jsxs(K,{className:z("group relative z-10 m-1 flex items-center justify-start gap-2 rounded-xl px-2 py-1.5 transition-all duration-200 ease-in-out",l?"flex-1 justify-center text-nowrap p-1 px-3 text-sm text-text-secondary radix-state-active:bg-surface-hover radix-state-active:text-text-primary":"bg-transparent text-text-secondary radix-state-active:bg-surface-tertiary radix-state-active:text-text-primary"),value:a,ref:e=>v.current[a]=e,children:[s,m(t)]},a)))}),e.jsxs("div",{className:"overflow-auto sm:w-full sm:max-w-none md:pr-0.5 md:pt-0.5",children:[e.jsx(V,{value:I.GENERAL,tabIndex:-1,children:e.jsx(M,{})}),e.jsx(V,{value:I.CHAT,tabIndex:-1,children:e.jsx(F,{})}),e.jsx(V,{value:I.COMMANDS,tabIndex:-1,children:e.jsx(D,{})}),e.jsx(V,{value:I.SPEECH,tabIndex:-1,children:e.jsx(S,{})}),y&&e.jsx(V,{value:I.PERSONALIZATION,tabIndex:-1,children:e.jsx($,{hasMemoryOptOut:N,hasAnyPersonalizationFeature:y})}),e.jsx(V,{value:I.DATA,tabIndex:-1,children:e.jsx(P,{})}),(null==(o=null==c?void 0:c.balance)?void 0:o.enabled)&&e.jsx(V,{value:I.BALANCE,tabIndex:-1,children:e.jsx(R,{})}),e.jsx(V,{value:I.ACCOUNT,tabIndex:-1,children:e.jsx(H,{})})]})]})})]})})})]})})}const ae=u((function(){var a,s;const t=A(),{user:m,isAuthenticated:u,logout:p}=U(),{data:v}=L(),h=q({enabled:!!u&&(null==(a=null==v?void 0:v.balance)?void 0:a.enabled)}),[f,b]=d(!1),[g,_]=d(!1),k=x(null);return e.jsxs(i,{children:[e.jsxs(r,{ref:k,"aria-label":t("com_nav_account_settings"),"data-testid":"nav-user",className:"mt-text-sm flex h-auto w-full items-center gap-2 rounded-xl p-2 text-sm transition-all duration-200 ease-in-out hover:bg-surface-hover aria-[expanded=true]:bg-surface-hover",children:[e.jsx("div",{className:"-ml-0.9 -mt-0.8 h-8 w-8 flex-shrink-0",children:e.jsx("div",{className:"relative flex",children:e.jsx(y,{user:m,size:32})})}),e.jsx("div",{className:"mt-2 grow overflow-hidden text-ellipsis whitespace-nowrap text-left text-text-primary",style:{marginTop:"0",marginLeft:"0"},children:(null==m?void 0:m.name)??(null==m?void 0:m.username)??t("com_nav_user")})]}),e.jsxs(n,{className:"popover-ui w-[305px] rounded-lg md:w-[235px]",style:{transformOrigin:"bottom",translate:"0 -4px"},children:[e.jsx("div",{className:"text-token-text-secondary ml-3 mr-2 py-2 text-sm",role:"note",children:(null==m?void 0:m.email)??t("com_nav_user")}),e.jsx(N,{}),!0===(null==(s=null==v?void 0:v.balance)?void 0:s.enabled)&&null!=h.data&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-token-text-secondary ml-3 mr-2 py-2 text-sm",role:"note",children:[t("com_nav_balance"),":"," ",(new Intl.NumberFormat).format(Math.round(h.data.tokenCredits))]}),e.jsx(N,{})]}),e.jsxs(o,{value:"",onClick:()=>_(!0),className:"select-item text-sm",children:[e.jsx(l,{className:"icon-md","aria-hidden":"true"}),t("com_nav_my_files")]}),"/"!==(null==v?void 0:v.helpAndFaqURL)&&e.jsxs(o,{value:"",onClick:()=>window.open(null==v?void 0:v.helpAndFaqURL,"_blank"),className:"select-item text-sm",children:[e.jsx(w,{"aria-hidden":"true"}),t("com_nav_help_faq")]}),e.jsxs(o,{value:"",onClick:()=>b(!0),className:"select-item text-sm",children:[e.jsx(j,{className:"icon-md","aria-hidden":"true"}),t("com_nav_settings")]}),e.jsx(N,{}),e.jsxs(o,{"aria-selected":!0,onClick:()=>p(),value:"logout",className:"select-item text-sm",children:[e.jsx(c,{className:"icon-md","aria-hidden":"true"}),t("com_nav_log_out")]})]}),g&&e.jsx(G,{open:g,onOpenChange:_,triggerRef:k}),f&&e.jsx(ee,{open:f,onOpenChange:b})]})}));export{ae as default};
