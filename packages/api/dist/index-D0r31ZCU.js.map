{"version":3,"file":"index-D0r31ZCU.js","sources":["../../../node_modules/@aws-sdk/credential-provider-node/node_modules/@aws-sdk/credential-provider-web-identity/dist-es/fromWebToken.js","../../../node_modules/@aws-sdk/credential-provider-node/node_modules/@aws-sdk/credential-provider-web-identity/dist-es/fromTokenFile.js"],"sourcesContent":["export const fromWebToken = (init) => async (awsIdentityProperties) => {\n    init.logger?.debug(\"@aws-sdk/credential-provider-web-identity - fromWebToken\");\n    const { roleArn, roleSessionName, webIdentityToken, providerId, policyArns, policy, durationSeconds } = init;\n    let { roleAssumerWithWebIdentity } = init;\n    if (!roleAssumerWithWebIdentity) {\n        const { getDefaultRoleAssumerWithWebIdentity } = await import(\"@aws-sdk/nested-clients/sts\");\n        roleAssumerWithWebIdentity = getDefaultRoleAssumerWithWebIdentity({\n            ...init.clientConfig,\n            credentialProviderLogger: init.logger,\n            parentClientConfig: {\n                ...awsIdentityProperties?.callerClientConfig,\n                ...init.parentClientConfig,\n            },\n        }, init.clientPlugins);\n    }\n    return roleAssumerWithWebIdentity({\n        RoleArn: roleArn,\n        RoleSessionName: roleSessionName ?? `aws-sdk-js-session-${Date.now()}`,\n        WebIdentityToken: webIdentityToken,\n        ProviderId: providerId,\n        PolicyArns: policyArns,\n        Policy: policy,\n        DurationSeconds: durationSeconds,\n    });\n};\n","import { setCredentialFeature } from \"@aws-sdk/core/client\";\nimport { CredentialsProviderError } from \"@smithy/property-provider\";\nimport { externalDataInterceptor } from \"@smithy/shared-ini-file-loader\";\nimport { readFileSync } from \"fs\";\nimport { fromWebToken } from \"./fromWebToken\";\nconst ENV_TOKEN_FILE = \"AWS_WEB_IDENTITY_TOKEN_FILE\";\nconst ENV_ROLE_ARN = \"AWS_ROLE_ARN\";\nconst ENV_ROLE_SESSION_NAME = \"AWS_ROLE_SESSION_NAME\";\nexport const fromTokenFile = (init = {}) => async (awsIdentityProperties) => {\n    init.logger?.debug(\"@aws-sdk/credential-provider-web-identity - fromTokenFile\");\n    const webIdentityTokenFile = init?.webIdentityTokenFile ?? process.env[ENV_TOKEN_FILE];\n    const roleArn = init?.roleArn ?? process.env[ENV_ROLE_ARN];\n    const roleSessionName = init?.roleSessionName ?? process.env[ENV_ROLE_SESSION_NAME];\n    if (!webIdentityTokenFile || !roleArn) {\n        throw new CredentialsProviderError(\"Web identity configuration not specified\", {\n            logger: init.logger,\n        });\n    }\n    const credentials = await fromWebToken({\n        ...init,\n        webIdentityToken: externalDataInterceptor?.getTokenRecord?.()[webIdentityTokenFile] ??\n            readFileSync(webIdentityTokenFile, { encoding: \"ascii\" }),\n        roleArn,\n        roleSessionName,\n    })(awsIdentityProperties);\n    if (webIdentityTokenFile === process.env[ENV_TOKEN_FILE]) {\n        setCredentialFeature(credentials, \"CREDENTIALS_ENV_VARS_STS_WEB_ID_TOKEN\", \"h\");\n    }\n    return credentials;\n};\n"],"names":["CredentialsProviderError","externalDataInterceptor","readFileSync","setCredentialFeature"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAY,MAAC,YAAY,GAAG,CAAC,IAAI,KAAK,OAAO,qBAAqB,KAAK;AACvE,IAAI,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,0DAA0D,CAAC;AAClF,IAAI,MAAM,EAAE,OAAO,EAAE,eAAe,EAAE,gBAAgB,EAAE,UAAU,EAAE,UAAU,EAAE,MAAM,EAAE,eAAe,EAAE,GAAG,IAAI;AAChH,IAAI,IAAI,EAAE,0BAA0B,EAAE,GAAG,IAAI;AAC7C,IAAI,IAAI,CAAC,0BAA0B,EAAE;AACrC,QAAQ,MAAM,EAAE,oCAAoC,EAAE,GAAG,MAAM,oDAAO,qBAA6B,KAAC;AACpG,QAAQ,0BAA0B,GAAG,oCAAoC,CAAC;AAC1E,YAAY,GAAG,IAAI,CAAC,YAAY;AAChC,YAAY,wBAAwB,EAAE,IAAI,CAAC,MAAM;AACjD,YAAY,kBAAkB,EAAE;AAChC,gBAAgB,GAAG,qBAAqB,EAAE,kBAAkB;AAC5D,gBAAgB,GAAG,IAAI,CAAC,kBAAkB;AAC1C,aAAa;AACb,SAAS,EAAE,IAAI,CAAC,aAAa,CAAC;AAC9B;AACA,IAAI,OAAO,0BAA0B,CAAC;AACtC,QAAQ,OAAO,EAAE,OAAO;AACxB,QAAQ,eAAe,EAAE,eAAe,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;AAC9E,QAAQ,gBAAgB,EAAE,gBAAgB;AAC1C,QAAQ,UAAU,EAAE,UAAU;AAC9B,QAAQ,UAAU,EAAE,UAAU;AAC9B,QAAQ,MAAM,EAAE,MAAM;AACtB,QAAQ,eAAe,EAAE,eAAe;AACxC,KAAK,CAAC;AACN;;ACnBA,MAAM,cAAc,GAAG,6BAA6B;AACpD,MAAM,YAAY,GAAG,cAAc;AACnC,MAAM,qBAAqB,GAAG,uBAAuB;AACzC,MAAC,aAAa,GAAG,CAAC,IAAI,GAAG,EAAE,KAAK,OAAO,qBAAqB,KAAK;AAC7E,IAAI,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,2DAA2D,CAAC;AACnF,IAAI,MAAM,oBAAoB,GAAG,IAAI,EAAE,oBAAoB,IAAI,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC;AAC1F,IAAI,MAAM,OAAO,GAAG,IAAI,EAAE,OAAO,IAAI,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC;AAC9D,IAAI,MAAM,eAAe,GAAG,IAAI,EAAE,eAAe,IAAI,OAAO,CAAC,GAAG,CAAC,qBAAqB,CAAC;AACvF,IAAI,IAAI,CAAC,oBAAoB,IAAI,CAAC,OAAO,EAAE;AAC3C,QAAQ,MAAM,IAAIA,8BAAwB,CAAC,0CAA0C,EAAE;AACvF,YAAY,MAAM,EAAE,IAAI,CAAC,MAAM;AAC/B,SAAS,CAAC;AACV;AACA,IAAI,MAAM,WAAW,GAAG,MAAM,YAAY,CAAC;AAC3C,QAAQ,GAAG,IAAI;AACf,QAAQ,gBAAgB,EAAEC,+CAAuB,EAAE,cAAc,IAAI,CAAC,oBAAoB,CAAC;AAC3F,YAAYC,eAAY,CAAC,oBAAoB,EAAE,EAAE,QAAQ,EAAE,OAAO,EAAE,CAAC;AACrE,QAAQ,OAAO;AACf,QAAQ,eAAe;AACvB,KAAK,CAAC,CAAC,qBAAqB,CAAC;AAC7B,IAAI,IAAI,oBAAoB,KAAK,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,EAAE;AAC9D,QAAQC,0BAAoB,CAAC,WAAW,EAAE,uCAAuC,EAAE,GAAG,CAAC;AACvF;AACA,IAAI,OAAO,WAAW;AACtB;;;;;","x_google_ignoreList":[0,1]}