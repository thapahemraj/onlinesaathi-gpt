{"version":3,"file":"index-CfFIbSAz.js","sources":["../../../node_modules/@aws-sdk/credential-provider-node/node_modules/@aws-sdk/credential-provider-process/dist-es/getValidatedProcessCredentials.js","../../../node_modules/@aws-sdk/credential-provider-node/node_modules/@aws-sdk/credential-provider-process/dist-es/resolveProcessCredentials.js","../../../node_modules/@aws-sdk/credential-provider-node/node_modules/@aws-sdk/credential-provider-process/dist-es/fromProcess.js"],"sourcesContent":["import { setCredentialFeature } from \"@aws-sdk/core/client\";\nexport const getValidatedProcessCredentials = (profileName, data, profiles) => {\n    if (data.Version !== 1) {\n        throw Error(`Profile ${profileName} credential_process did not return Version 1.`);\n    }\n    if (data.AccessKeyId === undefined || data.SecretAccessKey === undefined) {\n        throw Error(`Profile ${profileName} credential_process returned invalid credentials.`);\n    }\n    if (data.Expiration) {\n        const currentTime = new Date();\n        const expireTime = new Date(data.Expiration);\n        if (expireTime < currentTime) {\n            throw Error(`Profile ${profileName} credential_process returned expired credentials.`);\n        }\n    }\n    let accountId = data.AccountId;\n    if (!accountId && profiles?.[profileName]?.aws_account_id) {\n        accountId = profiles[profileName].aws_account_id;\n    }\n    const credentials = {\n        accessKeyId: data.AccessKeyId,\n        secretAccessKey: data.SecretAccessKey,\n        ...(data.SessionToken && { sessionToken: data.SessionToken }),\n        ...(data.Expiration && { expiration: new Date(data.Expiration) }),\n        ...(data.CredentialScope && { credentialScope: data.CredentialScope }),\n        ...(accountId && { accountId }),\n    };\n    setCredentialFeature(credentials, \"CREDENTIALS_PROCESS\", \"w\");\n    return credentials;\n};\n","import { CredentialsProviderError } from \"@smithy/property-provider\";\nimport { externalDataInterceptor } from \"@smithy/shared-ini-file-loader\";\nimport { exec } from \"child_process\";\nimport { promisify } from \"util\";\nimport { getValidatedProcessCredentials } from \"./getValidatedProcessCredentials\";\nexport const resolveProcessCredentials = async (profileName, profiles, logger) => {\n    const profile = profiles[profileName];\n    if (profiles[profileName]) {\n        const credentialProcess = profile[\"credential_process\"];\n        if (credentialProcess !== undefined) {\n            const execPromise = promisify(externalDataInterceptor?.getTokenRecord?.().exec ?? exec);\n            try {\n                const { stdout } = await execPromise(credentialProcess);\n                let data;\n                try {\n                    data = JSON.parse(stdout.trim());\n                }\n                catch {\n                    throw Error(`Profile ${profileName} credential_process returned invalid JSON.`);\n                }\n                return getValidatedProcessCredentials(profileName, data, profiles);\n            }\n            catch (error) {\n                throw new CredentialsProviderError(error.message, { logger });\n            }\n        }\n        else {\n            throw new CredentialsProviderError(`Profile ${profileName} did not contain credential_process.`, { logger });\n        }\n    }\n    else {\n        throw new CredentialsProviderError(`Profile ${profileName} could not be found in shared credentials file.`, {\n            logger,\n        });\n    }\n};\n","import { getProfileName, parseKnownFiles } from \"@smithy/shared-ini-file-loader\";\nimport { resolveProcessCredentials } from \"./resolveProcessCredentials\";\nexport const fromProcess = (init = {}) => async ({ callerClientConfig } = {}) => {\n    init.logger?.debug(\"@aws-sdk/credential-provider-process - fromProcess\");\n    const profiles = await parseKnownFiles(init);\n    return resolveProcessCredentials(getProfileName({\n        profile: init.profile ?? callerClientConfig?.profile,\n    }), profiles, init.logger);\n};\n"],"names":["setCredentialFeature","promisify","externalDataInterceptor","exec","CredentialsProviderError","parseKnownFiles","getProfileName"],"mappings":"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","x_google_ignoreList":[0,1,2]}